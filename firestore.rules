rules_version='2'

service cloud.firestore {
  match /databases/{database}/documents {
    
    // Activities collection - allow authenticated users to read their partner's activities
    match /activities/{activityId} {
      // Allow read if user is authenticated and the activity belongs to their partner
      allow read: if request.auth != null;
      // Write access is handled by the server (admin SDK) only
      allow write: if false;
    }
    
    // EditorUploads collection - allow authenticated users to read uploads for jobs
    match /editorUploads/{uploadId} {
      // Allow read if user is authenticated
      allow read: if request.auth != null;
      // Write access is handled by the server (admin SDK) only
      allow write: if false;
    }
    
    // Conversations collection - allow authenticated users to read/write their conversations
    match /conversations/{conversationId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Messages collection - allow authenticated users to read/write messages
    match /messages/{messageId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Notifications collection - allow authenticated users to read/write their notifications
    match /notifications/{notificationId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Jobs collection - allow authenticated users to read jobs
    match /jobs/{jobId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Orders collection - allow authenticated users to read/write orders
    match /orders/{orderId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Appointments collection - allow authenticated users to read/write appointments
    match /appointments/{appointmentId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Folders collection - allow authenticated users to read/write folders
    match /folders/{folderId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Users collection - allow authenticated users to read/write user data
    match /users/{userId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Partners collection - allow authenticated users to read/write partner data
    match /partners/{partnerId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Customers collection - allow authenticated users to read/write customer data
    match /customers/{customerId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Editors collection - allow authenticated users to read/write editor data
    match /editors/{editorId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // OrderServices collection - allow authenticated users to read/write order services
    match /orderServices/{serviceId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // OrderFiles collection - allow authenticated users to read/write order files
    match /orderFiles/{fileId} {
      allow read: if request.auth != null;
      allow write: if request.auth != null;
    }
    
    // Fallback rule for any other collections - require authentication
    match /{document=**} {
      allow read, write: if request.auth != null;
    }
  }
}
